<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add Properties</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

  <link rel="stylesheet" href="css/main2.css">
  <link rel="stylesheet" href="css/profile.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="./script/appconst.js"></script>
  <script src="./script/script.js"></script>
  <link rel="stylesheet" href="css/normal.css">
  <!-- Vendor CSS Files -->
  <style>
    .btn {
      border-radius: 0.375rem;
      font-weight: 500 !important;
    }

    .btn-secondary:hover {
      background-color: #83838359 !important;
      color: white !important;
    }


    html,
    body {
      background-color: #f4f4f9;
    }

    .container {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      flex-grow: 1;
      height: calc(100% - 5rem);
      width: 100%;

      box-sizing: border-box;
    }

    .pagetitle {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }

    .custom-toggle-item {
      margin-top: auto;
      margin-bottom: auto;
    }


    .button-container {
      display: flex;
      justify-content: flex-end;
      margin-top: 8%;
    }

    .add-properties-button {
      background-color: var(--primary);
      color: white;
      border: none;
      padding: 10px 50px;
      font-size: 14px;
      cursor: pointer;
      border-radius: 6px;
    }

    .add-properties-button:hover {
      background-color: var(--primary);
    }

    @media (max-width: 992px) {
      .image-preview {
        display: grid;
        grid-template-columns: auto auto auto auto;
      }

      .image-preview img {
        width: 100%;
      }

      .upload-section {
        display: block;
      }

      .upload-box {
        height: 50%;
      }
    }

    @media (max-width: 490px) {
      .upload-box {
        height: 40%;
      }

      .image-preview {
        display: grid;
        grid-template-columns: auto auto;
      }
    }

    .upload-section {
      grid-template-rows: 41% 15% 39%;
    }

    .upload-text {
      margin-top: unset;
      padding: 10px;
    }

    .upload-box p {
      font-size: 0.8rem;
    }

    .form-label {
      font-size: 0.8rem;
    }

    .form-control::placeholder {
      font-size: 0.75rem;
    }

    .form-control {
      /* padding: 0.70rem 0.5625rem; */
    }

    .input-height {
      height: 2.25rem !important;
    }

    .toggle-group {
      display: flex;
      /* justify-content: center; */
      align-items: center;
      /* flex-wrap: wrap; */
      gap: 10px;
    }

    .toggle-item {
      display: flex;
      align-items: center;
      /* gap: 10px; */
      /* flex-wrap: nowrap; */
    }

    input.toggle {
      display: none;
    }

    .switch {
      width: 54px;
      height: 25px;
    }

    .slider:before {
      bottom: 0.25em;
    }

    .form-divider {
      border: 1px dashed #4154F1;
      margin: 2% 0 2% 0;
    }

    .mb-3 {
      margin-bottom: 0.5rem !important;
    }

    .custom-switch {
      width: 3.2em;
      height: 1.5em;
    }

    .custom-slider:before {
      height: 1.1em;
      width: 1.1em;
    }

    input:checked+.custom-slider:before {
      transform: translateX(1.8em);
      left: 0.1em;
    }

    .custom-switch-text {
      font-weight: 650;
    }

    .upload-text {
      border-bottom: 0.125rem dashed #4154f1b3;
    }

    .upload-center-text {
      font-size: 0.8rem;
    }

    @media (max-width: 992px) {
      .toggle-group {
        /* justify-content: center; */
        flex-wrap: wrap;
      }

      .switch {
        width: 37px;
        height: 17px;
      }

      .slider:before {
        height: 0.8rem;
        top: 0.1rem;
        left: 0;
        width: 0.8rem;
      }

      input:checked+.slider:before {
        transform: translateX(1.4em);
      }

      .switch-text {
        font-size: 0.8rem;
        font-weight: 700;
      }
    }

    @media (max-width: 490px) {
      .upload-section {
        min-height: 50%;
      }

      .upload-text {
        margin-bottom: unset;
      }

      .image-preview {
        justify-content: center;
        grid-template-columns: 45% 45%;
        margin-top: 0.5rem;
      }

      .switch-text {
        font-size: 0.7rem;
      }

      .toggle-item {
        gap: 0 10px;
        /* display: grid; */
        grid-template-columns: 25% 0;
        max-width: 100%;
        justify-content: unset;
        transform: unset;
      }

      .switch {
        width: 34px;
        height: 16px;
      }

      .slider:before {
        height: 0.8rem;
        top: 1px;
        left: -3px;
        bottom: 0;
        width: 0.8rem;
      }

      .toggle-group {
        display: grid;
        grid-template-columns: 50% 50%;
        justify-content: space-around;
        grid-auto-rows: 38px;
        grid-auto-flow: dense;
      }

      ol.breadcrumb {
        font-size: 0.7rem;
      }


      .breadcrumb-devider {
        margin: 0 3px;
      }

      .custom-switch {
        width: 2.5em;
        height: 1.3em;
      }

      .custom-slider:before {
        height: 1em;
        width: 1em;
      }

      .heading-button {
        align-self: flex-end;
        transform: scale(0.8);
      }

      input:checked+.custom-slider:before {
        transform: translateX(0.8em);
        left: 0.5em;
      }
    }

    @media (max-width: 400px) {
      .upload-section {
        min-height: 50%;
      }
    }

    @media (max-width: 375px) {
      .upload-section {
        min-height: 44%;
      }
    }

    @media (max-width: 350px) {
      .upload-section {
        min-height: 45%;
      }
    }

    @media (max-width: 300px) {
      .upload-section {
        min-height: 40%;
      }

      input:checked+.slider:before {
        transform: translateX(1.1em);
      }
    }

    .form-section {
      display: flex;
      flex-direction: column;
    }

    .form-section .button-container {
      margin-top: auto;
    }

    @media (min-width:992px) {
      .form-section {
        padding: 15px 20px;
        height: 98%;
      }

      .upload-section {
        height: 98%;
        grid-template-rows: 41% 12% 39%;
      }
    }



    .image-preview-container {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
    max-height: 400px;
    overflow-x: hidden;
    width: 100%;
    max-height: 29vh;
}
@media screen and (max-width: 1200px) and (min-width: 992px) {
    .image-preview-container {
        max-height: 29vh;
    }
}
@media screen and (max-width: 1640px) and (min-width: 1200px) {
    .image-preview-container {
        max-height: 35vh;
    }
}
.image-preview {
  position: relative;
  overflow: hidden; /* Ensures the overlay stays within the image bounds */

    width: 103%;
    max-height: 103%;
}

.image-preview img {
  width:95%;
  display: block;
}

.image-preview .overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5); /* Adjust the color and opacity as needed */
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: opacity 0.3s;
  visibility: hidden; /* Initially hidden */
}

.image-preview:hover .overlay {
  opacity: 1;
}

.overlay-icons {
  display: flex;
  gap: 10px; /* Adjust the gap between icons */
}

.overlay-icons img {
  width: 24px; /* Adjust icon size as needed */
  height: 24px;
  cursor: pointer;
}
/* The Modal (background) */
.modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1000; /* Sit on top */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0, 0, 0); /* Fallback color */
  background-color: rgba(0, 0, 0, 0.9); /* Black w/ opacity */
}

/* Modal Content (image) */
.modal-content {
  margin: auto;
  display: block;
  width: 50%;
  max-width: 700px;
}

/* Close button */
.close {
  position: absolute;
  top: 15px;
  right: 35px;
  color: #f1f1f1;
  font-size: 40px;
  font-weight: bold;
  transition: 0.3s;
}

.close:hover,
.close:focus {
  color: #bbb;
  text-decoration: none;
  cursor: pointer;
}

  </style>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      initializeAll();
    });
  </script>
</head>

<body>

  <main id="main-content" class="main-content">

    <div class="pagetitle">
      <div class="title-nav">
        <h1>My Properties</h1>
        <nav>
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="myproperties.html">My properties / </a></li>

            <li class="breadcrumb-item active">Add Properties</li>
          </ol>
        </nav>
      </div>

      <!-- status-button -->
      <div class="custom-toggle-item heading-button">
        <label class="custom-switch">
          <input type="checkbox" id="customSwitch">
          <span class="custom-slider"></span>
        </label>
        <span class="custom-switch-text" id="customSwitchText">Status</span>
      </div>
    </div>

    <div id="header-container"></div>
    <div id="sidebar-container"></div>

    <div class="container container-responsive">
      <div class="upload-section">
        <div class="upload-box" id="uploadBox">
          <img src="./images/upload_img.svg" alt="Upload Icon" style="width: 50px; height: 50px;">
          <p class="upload-selection-text"><span>Click to upload </span><span>or</span><span> drag and drop</span>
            <input type="file" id="fileInput" accept="image/*" multiple>
          </p>
        </div>
        <div class="upload-text">
          <p class="upload-center-text">Max file size: 15 MB</p>
        </div>

        <!-- img preview -->
        <div class="image-preview-container" id="imagePreview"></div>

      </div>

      <div class="form-section">
        <div class="mb-3">
          <label for="properties name" class="form-label">Properties name</label>
          <input type="text" class="form-control input-height" id="properties-name"
            placeholder="Enter your properties name">
          <div id="nameError" class="error-msg"></div>
        </div>
        <div class="mb-3">
          <label for="address" class="form-label">Address</label>
          <input type="text" class="form-control input-height" id="address" placeholder="Enter your address">
          <div id="addressError" class="error-msg"></div>
        </div>

        <div class="row mb-3">
          <div class="col">
            <label for="country" class="form-label">Country</label>
            <select class="form-control input-height select-address" id="country">
              <option value="" selected disabled hidden>Select your country</option>
              <!-- Add country options here -->
              <option value="us">United States</option>
              <option value="ca">Canada</option>
              <!-- Add more countries as needed -->
            </select>
            <div id="countryError" class="error-msg"></div>
          </div>

          <div class="col">
            <label for="state" class="form-label">State</label>
            <select class="form-control input-height select-address" id="state">
              <option value="" selected disabled hidden>Select your state</option>
              <!-- Add state options here -->
              <option value="ny">New York</option>
              <option value="ca">California</option>
              <!-- Add more states as needed -->
            </select>
            <div id="stateError" class="error-msg"></div>
          </div>

          <div class="col">
            <label for="city" class="form-label">City</label>
            <select class="form-control input-height select-address" id="city">
              <option value="" selected disabled hidden>Select your city</option>
              <!-- Add city options here -->
              <option value="nyc">New York City</option>
              <option value="la">Los Angeles</option>
              <!-- Add more cities as needed -->
            </select>
            <div id="cityError" class="error-msg"></div>
          </div>
        </div>


        <div class="row mb-3">
          <div class="col">
            <label for="floors" class="form-label">No. Of Floors</label>
            <input type="text" class="form-control border-rad input-height" id="floors" placeholder="Enter your floors">
            <div id="floorsError" class="error-msg"></div>
          </div>
          <div class="col">
            <label for="rooms" class="form-label">No. Of Rooms</label>
            <input type="text" class="form-control border-rad input-height" id="rooms" placeholder="Enter your rooms">
            <div id="roomError" class="error-msg"></div>
          </div>
        </div>
        <div class="row mb-3">
          <div class="col">
            <label for="living" class="form-label">No. Of Living</label>
            <input type="text" class="form-control border-rad input-height" id="living" placeholder="Enter your living">
            <div id="livingError" class="error-msg"></div>
          </div>
          <div class="col">
            <label for="washroom" class="form-label">No. Of Washroom</label>
            <input type="text" class="form-control border-rad input-height" id="washroom"
              placeholder="Enter your washroom">
            <div id="washroomError" class="error-msg"></div>
          </div>
        </div>

        <hr class="form-divider">

        <div class="toggle-group">
          <div class="toggle-item" style="gap: 0.5rem;">
            <label class="switch">
              <input type="checkbox" class="toggle" id="carpet">
              <span class="slider"></span>
            </label>
            <span class="switch-text">Carpet Cloth</span>
          </div>
          <div class="toggle-item" style="gap: 0.5rem;">
            <label class="switch">
              <input type="checkbox" class="toggle" id="pool">
              <span class="slider"></span>
            </label>
            <span class="switch-text">Swimming Pool</span>
          </div>
          <div class="toggle-item" style="gap: 0.5rem;">
            <label class="switch">
              <input type="checkbox" class="toggle" id="frontYard">
              <span class="slider"></span>
            </label>
            <span class="switch-text">Front Yard</span>
          </div>
          <div class="toggle-item" style="gap: 0.5rem;">
            <label class="switch">
              <input type="checkbox" class="toggle" id="backYard">
              <span class="slider"></span>
            </label>
            <span class="switch-text">Back Yard</span>
          </div>
        </div>


        <div class="button-container">
          <a class="add-properties-button" href="" onclick="handleAddPropertices(event)">Save</a>
        </div>
      </div>
    </div>
  </main>

  <div id="imageModal" class="modal">
    <span class="close">&times;</span>
    <img class="modal-content" id="fullImage">
  </div>

  <script>
    var imgPaths = [];
    $(document).ready(function () {
      $('#fileInput').on('change', function (event) {
        var formData = new FormData();

        // Append all selected files to the FormData object
        $.each(this.files, function (i, file) {
          formData.append('images', file);
        });

        // Send the FormData object to the API endpoint
        $.ajax({
          url: apiUrl + 'PropertyPhotos/upload',
          type: 'POST',
          data: formData,
          headers: {
            "Authorization": `Bearer ${jwtToken}`
          },
          processData: false, // Do not process data
          contentType: false, // Do not set content type header
          success: function (response) {
            console.log('Files uploaded successfully:', response);
            console.log('Files paths:', response.data.filePaths.split('#:#'));
            imgPaths.push(...response.data.filePaths.split('#:#'));
          },
          error: function (jqXHR, textStatus, errorThrown) {
            console.error('File upload failed:', textStatus, errorThrown);
          }
        });
      });
    });

  </script>
 <script>
  const MAX_IMAGES = 4;
const DUMMY_IMAGE_SRC = 'images/preview_img.png';

function handleFiles(files) {
  const imagePreviewContainer = document.getElementById('imagePreview');
  const totalFiles = files.length;
  const uploadedImages = [];

  // Remove existing images
  while (imagePreviewContainer.firstChild) {
    imagePreviewContainer.removeChild(imagePreviewContainer.firstChild);
  }

  for (const file of files) {
    if (file.size <= 15 * 1024 * 1024) {
      const reader = new FileReader();
      reader.onload = function (event) {
        const imagePreview = document.createElement('div');
        imagePreview.classList.add('image-preview');

        const imgElement = document.createElement('img');
        imgElement.src = event.target.result;
        imagePreview.appendChild(imgElement);

        const overlay = document.createElement('div');
        overlay.classList.add('overlay');

        const overlayIcons = document.createElement('div');
        overlayIcons.classList.add('overlay-icons');

        const viewIcon = document.createElement('img');
        viewIcon.src = 'images/eye_icon.svg';
        viewIcon.alt = 'View';
        overlayIcons.appendChild(viewIcon);

        const deleteIcon = document.createElement('img');
        deleteIcon.src = 'images/delete_icon.svg';
        deleteIcon.alt = 'Delete';
        overlayIcons.appendChild(deleteIcon);

        overlay.appendChild(overlayIcons);
        imagePreview.appendChild(overlay);

        imagePreviewContainer.appendChild(imagePreview);

        // Show overlay when an image is uploaded
        overlay.style.visibility = 'visible';

        // Add delete functionality
        deleteIcon.addEventListener('click', () => {
          imagePreviewContainer.removeChild(imagePreview);
          displayDummyImages(uploadedImages.length - 1);
        });

        // Add view functionality
        viewIcon.addEventListener('click', () => {
          showModal(event.target.result);
        });

        uploadedImages.push(event.target.result);
        displayDummyImages(totalFiles);
      };
      reader.readAsDataURL(file);
    } else {
      alert('File is too large: ' + file.name);
    }
  }

  displayDummyImages(totalFiles);
}

function displayDummyImages(uploadedImagesCount) {
  const imagePreviewContainer = document.getElementById('imagePreview');
  const dummyImagesCount = MAX_IMAGES - uploadedImagesCount;

  for (let i = 0; i < dummyImagesCount; i++) {
    const imagePreview = document.createElement('div');
    imagePreview.classList.add('image-preview');

    const imgElement = document.createElement('img');
    imgElement.src = DUMMY_IMAGE_SRC;
    imagePreview.appendChild(imgElement);

    imagePreviewContainer.appendChild(imagePreview);
  }
}

function showModal(imageSrc) {
  const modal = document.getElementById('imageModal');
  const fullImage = document.getElementById('fullImage');
  const closeButton = document.getElementsByClassName('close')[0];

  fullImage.src = imageSrc;
  modal.style.display = 'flex';

  closeButton.onclick = function() {
    modal.style.display = 'none';
  }

  window.onclick = function(event) {
    if (event.target == modal) {
      modal.style.display = 'none';
    }
  }
}

document.addEventListener('DOMContentLoaded', function () {
  const fileInput = document.getElementById('fileInput');
  const uploadBox = document.getElementById('uploadBox');

  uploadBox.addEventListener('click', function () {
    fileInput.click();
  });

  fileInput.addEventListener('change', function (event) {
    handleFiles(event.target.files);
  });

  uploadBox.addEventListener('dragover', function (event) {
    event.preventDefault();
    event.stopPropagation();
    this.style.borderColor = '#007bff';
  });

  uploadBox.addEventListener('dragleave', function (event) {
    event.preventDefault();
    event.stopPropagation();
    this.style.borderColor = '#ccc';
  });

  uploadBox.addEventListener('drop', function (event) {
    event.preventDefault();
    event.stopPropagation();
    this.style.borderColor = '#ccc';
    handleFiles(event.dataTransfer.files);
  });

  // Display initial dummy images
  displayDummyImages(0);
});

 </script>

  <script>
    setContryData();

    setStateData();
    setCityData();
    editAddPropertices()
  </script>


</body>

</html>